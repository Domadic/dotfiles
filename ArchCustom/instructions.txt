Version 8

# Setup look
loadkeys cz-qwertz
setfont Lat2-Terminus16

# Folder with custom files
cd /run/archiso/bootmnt

# Setup disk
cfdisk /dev/sda [15360]
mkfs.ext4 /dev/sdaX
mount /dev/sdaX /mnt

# Setup network
rfkill list
rfkill unblock #
tar xf Broadcom_Firmware.tar.gz -C /lib/firmware/
modprobe -r b43
modprobe b43
wifi-menu

# Setup mirrorlist
cp mirrorlist /etc/pacman.d/mirrorlist

# Setup system clock
timedatectl set-ntp true

# Setup base
pacstrap /mnt base base-devel
arch-chroot /mnt pacman -S intel-ucode grub-bios vim
genfstab -p /mnt >> /mnt/etc/fstab

# Copy custom files into installation folder
mkdir /mnt/home/files
cp * /mnt/home/files
chmod -R 777 /mnt/home/files
arch-chroot /mnt

# Setup hostname
echo *HOSTNAME* > /etc/hostname

# Setup time
ln -s /usr/share/zoneinfo/Europe/Prague /etc/localtime
hwclock --systohc --utc

# Setup terminal
nano /etc/vconsole.conf
-> KEYMAP=cz-qwertz
-> FONT=Lat2-Terminus16

# Setup locale
nano /etc/locale.gen
-> Uncomment `en_US.UTF-8`
echo 'LANG=en_US.UTF-8' > /etc/locale.conf
export LANG=en_US.UTF-8
locale-gen

# Setup linux image
mkinitcpio -p linux

# Setup GRUB
grub-mkconfig -o /boot/grub/grub.cfg
nano /boot/grub/grub.cfg
-> Change resolution
mkdir /boot/grub/locale
cp /usr/share/locale/en\@quot/LC_MESSAGES/grub.mo /boot/grub/locale/en.mo
grub-install --recheck /dev/sda

# Setup user
passwd root
useradd -m -g users -G wheel,http -s /bin/bash drstiny
passwd drstiny
visudo
-> Uncomment '%wheel'

# Install basic software
pacman -S xorg-server xorg-xinit xorg-apps mesa nvidia-340xx
pacman -S xf86-input-synaptics alsa-utils alsa-plugins pulseaudio-alsa
pacman -S slim archlinux-themes-slim
pacman -S i3 dmenu rxvt-unicode
pacman -S networkmanager network-manager-applet
pacman -S wireless_tools wpa_supplicant b43-fwcutter dialog
cd /home/files
su drstiny
-> Extract and install b43-firmware-classic (makepkg -si)

# Configure login manager
nano /etc/slim.conf
-> Set theme to archlinux-simplyblack
-> Enable numlock
-> Set default user
-> Set focus password

# Configure X
cp /etc/X11/xinit/xinitrc /home/*username*/.xinitrc
chmod +x /home/*username*/.xinitrc
nano /home/*username*/.xinitrc
-> Add `exec i3`

# Configure keyboard
nano /usr/share/X11/xorg.conf.d/40-libinput.conf
-> Add `Option "XkbLayout" "cz"` to keyboard

# Configure services
systemctl enable slim NetworkManager fstrim.timer

# Let's go!
exit
umount -R /mnt
reboot